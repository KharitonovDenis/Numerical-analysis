# -*- coding: utf-8 -*-
"""–ß–ú1.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/14e0IgIVu0SH0Kjy0DeUijbSI5Tj1mt7w

##–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞: $ùë¢^{(3)}+8ùë¢=f(ùë•)$,
—Å –≥—Ä–∞–Ω–∏—á–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏:
$ùë¢(0)=ùë¢'(0)=0,\quad
ùë¢(1)=\alpha$
.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω–æ—Å—Ç–Ω—É—é —Å—Ö–µ–º—É –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –∏ —Ä–µ—à–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö
$h$ (—à–∞–≥ —Å–µ—Ç–∫–∏) –∏ $\alpha$.

## –§–∏–∑–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

–≠—Ç–æ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å **–∏–∑–≥–∏–± —É–ø—Ä—É–≥–æ–π –±–∞–ª–∫–∏** –ø–æ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º –Ω–∞–≥—Ä—É–∑–∫–∏. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –±–∞–ª–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –∏–ª–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–Ω–æ–≥–æ —É—Å–∏–ª–∏—è, –µ–µ –∏–∑–≥–∏–± –º–æ–∂–µ—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å—Å—è —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –ø–æ–¥–æ–±–Ω–æ–≥–æ –≤–∏–¥–∞, –≥–¥–µ:
-  $u(x)$  ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥–∏–±–∞ –±–∞–ª–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏—è  x  –≤–¥–æ–ª—å –µ—ë –¥–ª–∏–Ω—ã.
- –ß–ª–µ–Ω  $8u$  –º–æ–∂–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å –ª–∏–Ω–µ–π–Ω—ã–π –æ—Ç–∫–ª–∏–∫ –±–∞–ª–∫–∏ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω–æ–µ —É—Å–∏–ª–∏–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —É–ø—Ä—É–≥–∏–º–∏ —Å–∏–ª–∞–º–∏.
- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å  $f(x)$  –æ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–Ω–µ—à–Ω—é—é —Å–∏–ª—É –∏–ª–∏ –Ω–∞–≥—Ä—É–∑–∫—É, –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—É—é –∫ –±–∞–ª–∫–µ.

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–∞—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —É—á—ë—Ç–µ –≤—è–∑–∫–∏—Ö –∏–ª–∏ –¥–∏—Å—Å–∏–ø–∞—Ç–∏–≤–Ω—ã—Ö —Å–∏–ª –≤ —Å–∏—Å—Ç–µ–º–µ, –∏–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–∞—Ö, –≥–¥–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–ª—ã –∏ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–≤—è–∑–∞–Ω–æ —á–µ—Ä–µ–∑ —Å–ª–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

### –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- $u(0) = 0$  –∏  $u'(0) = 0$ : —ç—Ç–∏ —É—Å–ª–æ–≤–∏—è —á–∞—Å—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∏—é –æ–¥–Ω–æ–≥–æ –∫–æ–Ω—Ü–∞ –±–∞–ª–∫–∏ (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω—É–ª–µ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–≥–∏–±–∞).
-  $u(1) = \alpha$ : —É—Å–ª–æ–≤–∏–µ –Ω–∞ –¥—Ä—É–≥–æ–º –∫–æ–Ω—Ü–µ –±–∞–ª–∫–∏ ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–∏–±–æ –∑–∞–¥–∞–Ω–Ω–æ–µ —Å–º–µ—â–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ –±–∞–ª–∫–∏, –ª–∏–±–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π.

### –¢—Ä–µ—Ç—å—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è –∏ –µ—ë —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª

#### –í —Ç–µ–æ—Ä–∏–∏ —É–ø—Ä—É–≥–æ—Å—Ç–∏ –∏ –∏–∑–≥–∏–±–∞ –±–∞–ª–∫–∏:

1. **–ü–µ—Ä–≤–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è  $u'(x)$**: –≠—Ç–æ –Ω–∞–∫–ª–æ–Ω –±–∞–ª–∫–∏ –≤ —Ç–æ—á–∫–µ  $x$ , –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ –±–∞–ª–∫–∏ –≤ —ç—Ç–æ–π —Ç–æ—á–∫–µ.

2. **–í—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è  $u''(x)$**: –≠—Ç–æ –∫—Ä–∏–≤–∏–∑–Ω–∞ –±–∞–ª–∫–∏ –≤ —Ç–æ—á–∫–µ  $x$ , –∫–æ—Ç–æ—Ä–∞—è —Å–≤—è–∑–∞–Ω–∞ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —É–≥–ª–∞ –Ω–∞–∫–ª–æ–Ω–∞ –∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, —Å –∏–∑–≥–∏–±–∞—é—â–∏–º –º–æ–º–µ–Ω—Ç–æ–º.

3. **–¢—Ä–µ—Ç—å—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è  $u^{(3)}(x)$**: –≠—Ç–∞ –≤–µ–ª–∏—á–∏–Ω–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫—Ä–∏–≤–∏–∑–Ω—ã –±–∞–ª–∫–∏. –û–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –∫—Ä–∏–≤–∏–∑–Ω–∞ –º–µ–Ω—è–µ—Ç—Å—è –≤–¥–æ–ª—å –±–∞–ª–∫–∏. –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ, —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏–∑–≥–∏–±–∞—é—â–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≤–¥–æ–ª—å –±–∞–ª–∫–∏ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ –º–µ—Ö–∞–Ω–∏–∫–∏ —É–ø—Ä—É–≥–∏—Ö –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–π, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–ª—ã –∏–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫—Ä–∏–≤–∏–∑–Ω—ã.

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–Ω–æ—Å—Ç–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –≤—Ç–æ—Ä–æ–≥–æ –∏ —Ç—Ä–µ—Ç—å–µ–≥–æ –ø–æ—Ä—è–¥–∫–æ–≤ –≤ –∑–∞–¥–∞—á–µ —Å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º $ u^{(3)}(x) + 8u(x) = f(x) $ —Å —à–∞–≥–æ–º —Å–µ—Ç–∫–∏ $ h $, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ö–µ–º—ã –∫–æ–Ω–µ—á–Ω—ã—Ö —Ä–∞–∑–Ω–æ—Å—Ç–µ–π. –ó–¥–µ—Å—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –¥–ª—è –≤—Ç–æ—Ä–æ–π –∏ —Ç—Ä–µ—Ç—å–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö —Å **–≤—Ç–æ—Ä—ã–º –ø–æ—Ä—è–¥–∫–æ–º —Ç–æ—á–Ω–æ—Å—Ç–∏**.

### 1. –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –ø–µ—Ä–≤–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $ u'(x) $

–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —Ä–∞–∑–Ω–æ—Å—Ç–Ω—É—é –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—é –¥–ª—è –ø–µ—Ä–≤–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $ u'(x) $:  
$
u'(x_i) \approx \frac{u_{i+1} - u_{i}}{h} + O(h^2).
$

–ì–¥–µ $ u_i = u(x_i) $ ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —É–∑–ª–µ $ x_i = i \cdot h $, –∞ $ h $ ‚Äî —à–∞–≥ —Å–µ—Ç–∫–∏.

### 2. –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $ u''(x) $

–í—Ç–æ—Ä–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è $ u''(x) $ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ä–∞–∑–Ω–æ—Å—Ç–Ω–æ–π —Å—Ö–µ–º–æ–π:
$
u''(x_i) \approx \frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + O(h^2).
$

–≠—Ç–∞ —Å—Ö–µ–º–∞ —Ç–∞–∫–∂–µ –æ–±–ª–∞–¥–∞–µ—Ç –≤—Ç–æ—Ä—ã–º –ø–æ—Ä—è–¥–∫–æ–º —Ç–æ—á–Ω–æ—Å—Ç–∏.

### 3. –†–∞–∑–Ω–æ—Å—Ç–Ω–∞—è –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è —Ç—Ä–µ—Ç—å–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $ u^{(3)}(x) $

–î–ª—è —Ç—Ä–µ—Ç—å–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π $ u^{(3)}(x) $ –ø—Ä–∏–º–µ–Ω–∏–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é —Ä–∞–∑–Ω–æ—Å—Ç–Ω—É—é —Å—Ö–µ–º—É –≤—Ç–æ—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞:
$
u^{(3)}(x_i) \approx \frac{u_{i+2} - 2u_{i+1} + 2u_{i-1} - u_{i-2}}{2h^3} + O(h^2).
$
–≠—Ç–∞ —Å—Ö–µ–º–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ—Ç —Ç—Ä–µ—Ç—å—é –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—É—é —Å **–≤—Ç–æ—Ä—ã–º –ø–æ—Ä—è–¥–∫–æ–º —Ç–æ—á–Ω–æ—Å—Ç–∏**.

### 4. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ

–ü–æ–¥—Å—Ç–∞–≤–∏–º —ç—Ç–∏ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ $ u^{(3)}(x) + 8u(x) = f(x) $ –≤ —É–∑–ª–µ $x_i $:
$
\frac{u_{i+2} - 2u_{i+1} + 2u_{i-1} - u_{i-2}}{2h^3} + 8u_i = f_i.
$

–ì–¥–µ $ f_i = f(x_i) $.

### 5. –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

–ì—Ä–∞–Ω–∏—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è $ u(0) = u'(0) = 0 $ –∏ $ u(1) = \alpha $ –∑–∞–¥–∞—é—Ç—Å—è —è–≤–Ω–æ:
- $ u_0 = 0 $,
- $ \frac{u_1 - u_{0}}{h} = 0 $ (–ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–µ –≥—Ä–∞–Ω–∏—á–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è –ø–µ—Ä–≤–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –≤ —Ç–æ—á–∫–µ $ x = 0 $),
- $ u_{N+1} = \alpha $, –≥–¥–µ $ N+1 $ ‚Äî –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É–∑–ª–∞ —Å–µ—Ç–∫–∏ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ $ x = 1 $).

### 6. –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–∏–Ω–µ–π–Ω—ã—Ö –∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∏—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π (–°–õ–ê–£)

–ü–æ—Å–ª–µ –¥–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π, –ø–æ–ª—É—á–∞–µ–º —Å–∏—Å—Ç–µ–º—É –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ $ u_i $ –≤ —É–∑–ª–∞—Ö —Å–µ—Ç–∫–∏. –≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è:
$
A \mathbf{u} = \mathbf{f},
$
–≥–¥–µ:
- $ A $ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–∞–∑–Ω–æ—Å—Ç–Ω–æ–π –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏,
- $ \mathbf{u} $ ‚Äî –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π —Ñ—É–Ω–∫—Ü–∏–∏ $ u_i $,
- $ \mathbf{f} $ ‚Äî –≤–µ–∫—Ç–æ—Ä –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ $ f_i $.

–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —É –Ω–∞—Å –±—É–¥—É—Ç –∑–Ω–∞—á–µ–Ω–∏—è $u$ –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —É–∑–ª–∞—Ö –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏: $u_1,...,u_N$

–ò–∑ —É—Å–ª–æ–≤–∏–π $u'(0) = 0$ –∏ $u(0)=0$ –ø–æ–ª—É—á–∏–º: $0=\frac{u_{1} - u_{0}}{h}$, –∞ –∑–Ω–∞—á–∏—Ç $u_1=0$

–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ç—Ä–µ—Ç—å–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π –≤ —Ç–æ—á–∫–µ $x_1$ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –≤–≤–µ—Å—Ç–∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é $u_{-1}$. –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ–º $u_{-1} = u(-\frac{1}{h})‚âà u(0)-u'(0)h=0$

–ü–æ–ª—É—á–∏–º —Å–∏—Å—Ç–µ–º—É –∏–∑ $N-1$ –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π –¥–ª—è –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è $N-1$ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö $u_2,...,u_N$
$\begin{cases}
  -\frac{1}{h^3}u_{2}+\frac{1}{2h^3}u_{3} = f_1 \\
  8u_2-\frac{1}{h^3}u_{3}+\frac{1}{2h^3}u_{4} = f_2 \\
  -\frac{1}{2h^3}u_{i-2} + \frac{1}{h^3}u_{i-1}+8u_i-\frac{1}{h^3}u_{i+1}+\frac{1}{2h^3}u_{i+2} = f_i &\text{,   $i=3,...,N-2$} \\
  -\frac{1}{2h^3}u_{N-3} + \frac{1}{h^3}u_{N-2}+8u_{N-1}-\frac{1}{h^3}u_{N}+\frac{1}{2h^3}\alpha = f_{N-1}
\end{cases}$

### –ò—Ç–æ–≥:

–ü–æ–ª—É—á–∏–≤ —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π, –µ—ë –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —á–∏—Å–ª–µ–Ω–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–µ—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π
"""

import numpy as np
import matplotlib.pyplot as plt
import math

def zero(x): #–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ 0
    return np.zeros_like(x)
def exp(x): # e^x
    return np.exp(x)
def xexp(x): # x*e^x
    return np.exp(x)*x
def sin_plus_cos(x): # sin(x)+cos(x)
    return np.sin(x)+np.cos(x)

"""–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- $f_1(x) \equiv 0$
- $f_2(x)=e^x$
- $f_3(x)=xe^x$
- $f_4(x)=\sin{x}+\cos{x}$

–†–µ—à–µ–Ω–∏–µ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∏–º–µ–µ—Ç –≤–∏–¥ $u_{oo}(x)=C_1e^{-2x}+e^{x}(C_2\cos{\sqrt{3}x}+C_2\sin{\sqrt{3}x}), \quad C_i\in\mathbb{R}, \quad i=1,2,3$
"""

def homog_sol(x, C): # —Ä–µ—à–µ–Ω–∏–µ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è
    return C[0]*np.exp(-2*x) + np.exp(x)*(C[1]*np.cos(3**0.5*x) + C[2]*np.sin(3**0.5*x))

def matrix(N, alpha):
    A = np.zeros((N-1, N-1))
    h = 1/(N+1)
    for i in range(N-1):
        for j in range(i-3, i+2):
            if ((j < 0) or (j > N-2)):
                continue
            if i == j:
                A[i][j] = -1/h**3
            if j == (i-1):
                A[i][j] = 8
            if j == (i-2):
                A[i][j] = 1/h**3
            if j == (i-3):
                A[i][j] = -1/(2*h**3)
            if j == (i+1):
                A[i][j] = 1/(2*h**3)
    return A

def rhs(N, alpha, f):
    h = 1/(N+1)
    x = np.linspace(0, 1, N+2)
    b = f(x)[1:N]
    b[N-2] -= alpha/(2*h**3)
    return b

def approx(N, alpha, f):
    u = np.linalg.solve(matrix(N, alpha), rhs(N, alpha, f))
    u_01 = np.array([0, 0])
    u_last = np.array([alpha])
    return np.concatenate((u_01, u, u_last))

def sol1(x, alpha): # —Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ f_1
    a = np.array([[1, 1, 0], [-2, 1, 3**0.5], [np.exp(-2), np.cos(3**0.5)*np.e, np.sin(3**0.5)*np.e]])
    r = np.array([0, 0, alpha])
    C = np.linalg.solve(a, r)
    return homog_sol(x, C)

def sol2(x, alpha): #—Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ f_2
    a = np.array([[1, 1, 0], [-2, 1, 3**0.5], [np.exp(-2), np.exp(1)*np.cos(3**0.5), np.exp(1)*np.sin(3**0.5)]])
    r = np.array([-1/9, -1/9, (-1/9)*np.e+alpha])
    C = np.linalg.solve(a, r)
    return homog_sol(x, C) + 1/9*np.exp(x)

def sol3(x, alpha): #—Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ f_3
    a = np.array([[1, 1, 0], [-2, 1, 3**0.5], [np.exp(-2), np.exp(1)*np.cos(3**0.5), np.exp(1)*np.sin(3**0.5)]])
    r = np.array([1/27, -2/27, alpha - 2*np.e/27])
    C = np.linalg.solve(a, r)
    return homog_sol(x, C) + 1/9*(x-1/3)*np.exp(x)

def sol4(x, alpha): #—Ç–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ f_4
    a = np.array([[1, 1, 0], [-2, 1, 3**0.5], [np.exp(-2), np.exp(1)*np.cos(3**0.5), np.exp(1)*np.sin(3**0.5)]])
    r = np.array([-9/65, -7/65, alpha - (7*np.sin(1) + 9*np.cos(1))/65])
    C = np.linalg.solve(a, r)
    return homog_sol(x, C) +1/65*(7*np.sin(x)+9*np.cos(x))

def show_plots(f, sol, alphas=range(5), Ns=(100, 1000)): # –í—ã–≤–æ–¥–∏—Ç –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏–∏ –∏ —Ç–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è sol –ø—Ä–∏ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ f
    for alpha in alphas:
        for N in Ns:
            h = 1/(N+1)
            x = np.linspace(0, 1, N+2)
            plt.figure(figsize=(12, 4))
            plt.subplot(1, 2, 1)
            plt.suptitle(f"alpha={alpha}, h={h:.4f}")
            plt.plot(x, approx(N, alpha, f))
            plt.title("–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ")
            plt.subplot(1, 2, 2)
            plt.plot(x, sol(x, alpha), color='green')
            plt.title("–¢–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ")
            plt.show()

fs = [zero, exp, xexp, sin_plus_cos]
names = ['f=0', 'f=exp(x)', 'f=x*exp(x)', 'f=sin(x)+cos(x)']
sols = [sol1, sol2, sol3, sol4]

alphas = (0, 0.01) # –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã alpha
Ns = (100,) # –ß–∏—Å–ª–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —É–∑–ª–æ–≤ –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏

#print('f(x)=0')
#show_plots(zero, sol1, alphas, Ns)

#print('f(x)=exp(x)')
#show_plots(exp, sol2, alphas, Ns)

#print('f(x)=x*exp(x)')
#show_plots(xexp, sol3, alphas, Ns)

#print('f(x)=sin(x)+cos(x)')
#show_plots(sin_plus_cos, sol4, alphas, Ns)

for func, solut, name in zip(fs, sols, names):
    print(name)
    show_plots(func, solut, alphas=alphas, Ns=Ns)

